#!/bin/bash
set -o errexit
set -o nounset
set -o pipefail

cd "$HOME/srv/webdav"

# {{- if .service.webdav }}

install -D --mode="u=rw,go=" --verbose /dev/null ./htpasswd
htpasswd -b "./htpasswd" \
  '{{ (rbw "WebDAV").data.username }}' \
  '{{ (rbw "WebDAV").data.password }}'

docker compose up --detach --pull always

# {{- else }}

docker compose down

# {{- end }}
